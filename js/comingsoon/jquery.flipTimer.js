!function(i){var s=function(t,n){this.element=t,this.element.hasClass("flipTimer")||this.element.addClass("flipTimer"),this.userOptions=n,this.defaultOptions=s.defaults,this.options=i.extend({},this.defaultOptions,this.userOptions),this.element.find(".seconds").length>0&&(this.options.seconds=this.element.find(".seconds")[0]),this.element.find(".minutes").length>0&&(this.options.minutes=this.element.find(".minutes")[0]),this.element.find(".hours").length>0&&(this.options.hours=this.element.find(".hours")[0]),this.element.find(".days").length>0&&(this.options.days=this.element.find(".days")[0]),this.initDate=new Date,this.options.date=new Date(this.options.date),this.calculateDate()};s.defaults={seconds:!1,minutes:!1,hours:!1,days:!1,date:"January 1, 2013 08:30:30",direction:"up",callback:null,digitTemplate:'<div class="digit">  <div class="digit-top">    <span class="digit-wrap"></span>  </div>  <div class="shadow-top"></div>  <div class="digit-bottom">    <span class="digit-wrap"></span>  </div>  <div class="shadow-bottom"></div></div>'},s.prototype={calculateDate:function(){var i;"down"==this.options.direction?i=this.options.date-this.initDate:"up"==this.options.direction&&(i=this.initDate-this.options.date),this.seconds=Math.floor(i/1e3)%60,this.minutes=Math.floor(i/1e3/60)%60,this.hours=Math.floor(i/1e3/3600)%24,this.days=Math.floor(i/1e3/60/60/24),this.render()},render:function(){this.options.seconds&&this.renderDigits(this.options.seconds,this.seconds),this.options.minutes&&this.renderDigits(this.options.minutes,this.minutes),this.options.hours&&this.renderDigits(this.options.hours,this.hours),this.options.days&&this.renderDigits(this.options.days,this.days),this.startTimer()},renderDigits:function(s,t){var n,e,o,d,a,r,h=this;0==i(s).find(".digit").length&&(r=h.days<0&&h.hours<0&&h.minutes<0&&h.seconds<0?[0,0]:h.days>99?[0,0]:String((t/10).toFixed(1)).split("."),d=s==h.options.seconds||s==h.options.minutes?5:s==h.options.hours?2:9,i(s).append('<div class="digit-set"></div><div class="digit-set"></div>'),i(s).find(".digit-set").each(function(s){for(o=0==s?d:9,n=0;o>=n;n++)i(this).append(h.options.digitTemplate),e="down"==h.options.direction?o-n:n,a=i(this).find(".digit")[n],i(a).find(".digit-wrap").append(e),e==r[s]?i(a).addClass("active"):0!=r[s]&&e+1==r[s]?i(a).addClass("previous"):0==r[s]&&e==o&&i(a).addClass("previous")}))},startTimer:function(){var i=this;clearInterval(this.timer),this.timer=setInterval(function(){return i.days<=0&&i.hours<=0&&i.minutes<=0&&i.seconds<=0?(i.options.callback&&i.options.callback(),void clearInterval(i.timer)):i.days>99||99==i.days&&23==i.hours&&59==i.minutes&&59==i.seconds?void clearInterval(i.timer):("down"==i.options.direction?i.seconds--:i.seconds++,i.options.seconds&&i.increaseDigit(i.options.seconds),(60==i.seconds||-1==i.seconds)&&("down"==i.options.direction?(i.seconds=59,i.minutes--):(i.seconds=0,i.minutes++),i.options.minutes&&i.increaseDigit(i.options.minutes)),(60==i.minutes||-1==i.minutes)&&("down"==i.options.direction?(i.minutes=59,i.hours--):(i.minutes=0,i.hours++),i.options.hours&&i.increaseDigit(i.options.hours)),void((24==i.hours||-1==i.hours)&&("down"==i.options.direction?(i.hours=23,i.days--):(i.hours=0,i.days++),i.options.days&&i.increaseDigit(i.options.days))))},1e3)},increaseDigit:function(s){function t(o){var d=i(o).find(".active"),a=i(o).find(".previous"),r=i.inArray(o,n);a.removeClass("previous"),d.removeClass("active").addClass("previous"),0==d.next().length?("down"!=e.options.direction||s!=e.options.hours||-1!=e.hours&&23!=e.hours||10!=i(o).find(".digit").length?i(o).find(".digit:first-child").addClass("active"):i(i(o).find(".digit")[6]).addClass("active"),0!=r&&t(n[r-1])):"up"==e.options.direction&&s==e.options.hours&&24==e.hours?(i(o).find(".digit:first-child").addClass("active"),t(n[r-1])):d.next().addClass("active")}var n=new Array,e=this;i(s).find(".digit-set").each(function(){n.push(this)}),t(n[n.length-1])}},i.fn.flipTimer=function(t){return this.each(function(){i(this).data("flipTimer")||i(this).data("flipTimer",new s(i(this),t))})}}(jQuery);